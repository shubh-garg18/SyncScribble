(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[968],{1040:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[roomId]",function(){return r(1846)}])},6724:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(t,{DM:function(){return o},rp:function(){return i}});var o={PURPLE:"#8B5CF6",BLUE:"#3B82F6",RED:"#EF4444",GREEN:"#10B981",GOLD:"#F59E0B",PINK:"#EC4899",MINT:"#06D6A0",CYAN:"#06B6D4",ORANGE:"#F97316",BACKGROUND:"#0F0F23",SURFACE:"#1A1A2E",ACCENT:"#16213E",TEXT_PRIMARY:"#E2E8F0",TEXT_SECONDARY:"#94A3B8",BORDER:"#334155"},i=a(Object.values(o));a(Object.values(o).filter((function(e){return e!==o.BACKGROUND}))).concat([o.BACKGROUND])},2782:function(e,t,r){"use strict";r.d(t,{W:function(){return n}});var n=(0,r(3264).io)()},7541:function(e,t,r){"use strict";r.d(t,{NW:function(){return n.NW},u4:function(){return n.u4},bo:function(){return n.bo},av:function(){return n.av}});r(5875);var n=r(3290)},5875:function(e,t,r){"use strict";r.d(t,{p:function(){return a},X:function(){return o}});var n=r(2804),a={id:"",users:new Map,usersMoves:new Map,movesWithoutUser:[],myMoves:[]},o=(0,n.cn)({key:"room",default:a})},3290:function(e,t,r){"use strict";r.d(t,{av:function(){return p},NW:function(){return f},bb:function(){return m},u4:function(){return b},bo:function(){return h}});var n=r(2804),a=r(6724),o=r(5875);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){s(e,t,r[t])}))}return e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"===typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}var f=function(){return(0,n.sJ)(o.X)},m=function(){return(0,n.Zl)(o.X)},b=function(){var e=(0,n.Zl)(o.X);return function(t){e(l({},o.p,{id:t}))}},h=function(){var e=(0,n.Zl)(o.X);return{handleAddUser:function(t,r){e((function(e){var n,o=e.users,i=e.usersMoves,s=function(e){var t=a.rp.filter((function(e){return e!==a.DM.BACKGROUND})),r=t.findIndex((function(t){return t===e}));return-1===r?t[0]:t[(r+1)%t.length]}(null===(n=u(o.values()).pop())||void 0===n?void 0:n.color);return o.set(t,{name:r,color:s}),i.set(t,[]),l({},e,{users:o,usersMoves:i})}))},handleRemoveUser:function(t){e((function(e){var r=e.users,n=e.usersMoves,a=n.get(t);return r.delete(t),n.delete(t),l({},e,{users:r,usersMoves:n,movesWithoutUser:u(e.movesWithoutUser).concat(u(a||[]))})}))},handleAddMoveToUser:function(t,r){e((function(e){var n=e.usersMoves,a=e.usersMoves.get(t);return n.set(t,u(a||[]).concat([r])),l({},e,{usersMoves:n})}))},handleRemoveMoveFromUser:function(t){e((function(e){var r=e.usersMoves,n=e.usersMoves.get(t);return null===n||void 0===n||n.pop(),r.set(t,n||[]),l({},e,{usersMoves:r})}))}}},p=function(){var e=c((0,n.FV)(o.X),2),t=e[0],r=e[1];return{handleAddMyMove:function(e){r((function(t){var r;return"select"===(null===(r=t.myMoves[t.myMoves.length-1])||void 0===r?void 0:r.options.mode)?l({},t,{myMoves:u(t.myMoves.slice(0,t.myMoves.length-1)).concat([e])}):l({},t,{myMoves:u(t.myMoves).concat([e])})}))},handleRemoveMyMove:function(){var e=u(t.myMoves),n=e.pop();return r((function(t){return l({},t,{myMoves:e})})),n},myMoves:t.myMoves}}},100:function(e,t,r){"use strict";var n=r(5893),a=r(8193),o=r(1513);t.Z=function(e){var t=e.id,r=(0,o.d)().closeModal;return(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in-up",children:(0,n.jsxs)("div",{className:"relative flex flex-col items-center rounded-2xl bg-slate-900/95 backdrop-blur-md border border-slate-700/50 p-8 max-w-md w-full shadow-2xl shadow-black/25 animate-fade-in-up",children:[(0,n.jsx)("button",{onClick:r,className:"absolute top-4 right-4 p-2 rounded-xl text-slate-400 hover:text-slate-200 hover:bg-slate-800/50 transition-all duration-200 hover:scale-110 active:scale-95",children:(0,n.jsx)(a.oHP,{size:20})}),(0,n.jsxs)("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-6 relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-red-500/20 rounded-full animate-ping"}),(0,n.jsx)("div",{className:"relative w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-white text-xl font-bold",children:"!"})})]}),(0,n.jsxs)("div",{className:"text-center space-y-4 mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-slate-200 leading-tight",children:"Room Not Found"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("p",{className:"text-slate-300 font-medium",children:["Room ",(0,n.jsxs)("span",{className:"px-2 py-1 bg-slate-800 rounded-md font-mono text-blue-400 border border-slate-700",children:['"',t,'"']})," doesn't exist or is full"]}),(0,n.jsx)("p",{className:"text-slate-400 text-sm",children:"The room may have been deleted or reached its participant limit."})]})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[(0,n.jsxs)("button",{onClick:r,className:"btn btn-primary flex-1 text-sm font-semibold relative overflow-hidden group",children:[(0,n.jsx)("span",{className:"relative z-10",children:"Try Again"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),(0,n.jsx)("button",{onClick:function(){r()},className:"btn flex-1 text-sm font-semibold border-slate-600 hover:border-slate-500 text-slate-300 hover:text-slate-200",children:"Create New Room"})]}),(0,n.jsx)("div",{className:"mt-6 p-4 bg-slate-800/30 rounded-xl border border-slate-700/30 w-full",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"w-5 h-5 bg-blue-500/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,n.jsx)("span",{className:"text-blue-400 text-xs",children:"\ud83d\udca1"})}),(0,n.jsxs)("div",{className:"text-slate-400 text-xs leading-relaxed",children:[(0,n.jsx)("p",{className:"font-medium text-slate-300 mb-1",children:"Tips:"}),(0,n.jsxs)("ul",{className:"space-y-1",children:[(0,n.jsx)("li",{children:"\u2022 Double-check the room ID for typos"}),(0,n.jsx)("li",{children:"\u2022 Ask the room creator for a new link"}),(0,n.jsx)("li",{children:"\u2022 Create your own room to get started"})]})]})]})})]})})}},1846:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Rt}});var n=r(5893),a=r(2804),o=(0,a.cn)({key:"bg",default:{mode:"light",lines:!0}}),i=r(7294),s=function(){var e=(0,a.sJ)(o);return(0,i.useEffect)((function(){var t=window.document.documentElement;"dark"===e.mode?(t.classList.remove("light"),t.classList.add("dark")):(t.classList.remove("dark"),t.classList.add("light"))}),[e.mode]),e},l=r(7541),c=r(4960),u=r(782),d=r(6724),f=r(2782),m=r(3290);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var x=(0,i.createContext)(null),v=function(e){var t=e.children,r=(0,m.bb)(),a=(0,m.NW)().users,o=(0,l.bo)(),s=o.handleAddUser,b=o.handleRemoveUser,v=(0,i.useRef)(null),g=(0,i.useRef)(null),y=(0,i.useRef)(null),w=(0,i.useRef)(null),j=(0,i.useRef)(null),N=(0,i.useRef)([]),k=(0,i.useState)({base64:""}),E=k[0],S=k[1],O=(0,c.c)(0),A=(0,c.c)(0);return(0,i.useEffect)((function(){return f.W.on("room",(function(e,t,n){var a=new Map(JSON.parse(t)),o=new Map(JSON.parse(n)),i=new Map;o.forEach((function(e,t){if(t!==f.W.id){var r=p(o.keys()).indexOf(t),n=d.rp[r%d.rp.length];i.set(t,{name:e,color:n})}})),r((function(t){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){h(e,t,r[t])}))}return e}({},t,{users:i,usersMoves:a,movesWithoutUser:e.drawed})}))})),f.W.on("new_user",(function(e,t){(0,u.Am)("".concat(t," has joined the room."),{position:"top-center",theme:"colored"}),s(e,t)})),f.W.on("user_disconnected",(function(e){var t;(0,u.Am)("".concat((null===(t=a.get(e))||void 0===t?void 0:t.name)||"Anonymous"," has left the room."),{position:"top-center",theme:"colored"}),b(e)})),function(){f.W.off("room"),f.W.off("new_user"),f.W.off("user_disconnected")}}),[s,b,r,a]),(0,n.jsx)(x.Provider,{value:{x:O,y:A,bgRef:w,undoRef:v,redoRef:g,canvasRef:y,setMoveImage:S,moveImage:E,minimapRef:j,selectionRefs:N},children:t})},g=r(7019),y=r(3750),w=4e3,j=2e3,N=function(){var e=(0,i.useState)(0),t=e[0],r=e[1],n=(0,i.useState)(0),a=n[0],o=n[1];return(0,i.useEffect)((function(){var e=function(){r(window.innerWidth),o(window.innerHeight)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),{width:t,height:a}},k=function(){var e=(0,i.useContext)(x);return{x:e.x,y:e.y}},E=function(){var e=(0,i.useContext)(x),t=e.undoRef,r=e.bgRef,n=e.canvasRef,a=e.minimapRef;return{undoRef:t,redoRef:e.redoRef,bgRef:r,canvasRef:n,minimapRef:a,selectionRefs:e.selectionRefs}},S=function(){var e=E().canvasRef,t=(0,i.useState)(),r=t[0],n=t[1];return(0,i.useEffect)((function(){var t,r=null===(t=e.current)||void 0===t?void 0:t.getContext("2d");r&&(r.lineJoin="round",r.lineCap="round",n(r))}),[e]),r},O={circle:{cX:0,cY:0,radiusX:0,radiusY:0},rect:{width:0,height:0},path:[],options:{shape:"line",mode:"draw",lineWidth:1,lineColor:{r:0,g:0,b:0,a:0},fillColor:{r:0,g:0,b:0,a:0},selection:null},id:"",img:{base64:""},timestamp:0},A=function(e,t){return e-t.get()},C=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},I=(0,a.cn)({key:"options",default:{lineColor:{r:0,g:0,b:0,a:1},fillColor:{r:0,g:0,b:0,a:0},lineWidth:5,mode:"draw",shape:"line",selection:null}});function M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){M(e,t,r[t])}))}return e}var P=function(){return(0,a.sJ)(I)},T=function(){return(0,a.FV)(I)},W=function(){var e=(0,a.Zl)(I);return{setSelection:function(t){e((function(e){return R({},e,{selection:t})}))},clearSelection:function(){e((function(e){return R({},e,{selection:null})}))}}},D=(0,a.cn)({key:"saved_moves",default:[]});function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var U=function(){var e=(0,a.Zl)(D);return{addSavedMove:function(t){"select"!==t.options.mode&&e((function(e){return[t].concat(L(e))}))},removeSavedMove:function(){var t;return e((function(e){return t=e.at(0),e.slice(1)})),t},clearSavedMoves:function(){e([])}}},z=function(e,t,r,n){var a=e-r[0],o=t-r[1];return n?Math.abs(a)>Math.abs(o)?a=a>0&&o<0||a<0&&o>0?-o:o:o=o>0&&a<0||o<0&&a>0?-a:a:(a=e-r[0],o=t-r[1]),{width:a,height:o}},F=function(e,t,r,n,a,o){e.beginPath();var i=z(r,n,t,a),s=i.width,l=i.height;return o?e.fillRect(t[0],t[1],s,l):e.rect(t[0],t[1],s,l),e.stroke(),e.fill(),e.closePath(),{width:s,height:l}};function Y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Y(e,t,r[t])}))}return e}var H,B=[],$={cX:0,cY:0,radiusX:0,radiusY:0},J={width:0,height:0},Z=function(e){var t=P(),r=k(),n=U().clearSavedMoves,a=(0,l.av)().handleAddMyMove,o=W(),s=o.setSelection,c=o.clearSelection,u=r.x,d=r.y,m=(0,i.useState)(!1),b=m[0],h=m[1],p=S(),x=function(){p&&(p.lineWidth=t.lineWidth,p.strokeStyle=C(t.lineColor),p.fillStyle=C(t.fillColor),"eraser"===t.mode?p.globalCompositeOperation="destination-out":p.globalCompositeOperation="source-over")},v=function(){H||(H=null===p||void 0===p?void 0:p.getImageData(0,0,p.canvas.width,p.canvas.height)),H&&(null===p||void 0===p||p.putImageData(H,0,0))},g=function(){v(),H=void 0};return{handleEndDrawing:function(){if(p&&!e){h(!1),p.closePath();var r=!0;if("select"===t.mode&&B.length){g();var o=B[0][0],i=B[0][1],l=B[B.length-1][0]-o,u=B[B.length-1][1]-i;l<0?(l-=4,o+=2):(l+=4,o-=2),u<0?(u-=4,i+=2):(u+=4,i-=2),(l<4||l>4)&&(u<4||u>4)?s({x:o,y:i,width:l,height:u}):(c(),r=!1)}var d=X({},O,{rect:X({},J),circle:X({},$),path:B,options:t});B=[],$={cX:0,cY:0,radiusX:0,radiusY:0},J={width:0,height:0},"select"!==t.mode?(f.W.emit("draw",d),n()):r&&a(d)}},handleDraw:function(r,n,a){if(p&&b&&!e){var o=[A(r,u),A(n,d)],i=o[0],s=o[1];if(v(),"select"===t.mode)return p.fillStyle="rgba(0, 0, 0, 0.2)",F(p,B[0],i,s,!1,!0),B.push([i,s]),void x();switch(t.shape){case"line":a&&(B=B.slice(0,1)),function(e,t,r,n,a){if(a)return e.beginPath(),e.lineTo(t[0],t[1]),e.lineTo(r,n),e.stroke(),void e.closePath();e.lineTo(r,n),e.stroke()}(p,B[0],i,s,a),B.push([i,s]);break;case"circle":$=function(e,t,r,n,a){e.beginPath();var o=z(r,n,t,a),i=o.width,s=o.height,l=t[0]+i/2,c=t[1]+s/2,u=Math.abs(i/2),d=Math.abs(s/2);return e.ellipse(l,c,u,d,0,0,2*Math.PI),e.stroke(),e.fill(),e.closePath(),{cX:l,cY:c,radiusX:u,radiusY:d}}(p,B[0],i,s,a);break;case"rect":J=F(p,B[0],i,s,a)}}},handleStartDrawing:function(r,n){if(p&&!e&&!e){var a=[A(r,u),A(n,d)],o=a[0],i=a[1];h(!0),x(),v(),"line"===t.shape&&"select"!==t.mode&&(p.beginPath(),p.lineTo(o,i),p.stroke()),B.push([o,i])}},drawing:b,clearOnYourMove:g}},G=r(4051),K=r.n(G),Q=function(){var e=(0,i.useContext)(x);return{moveImage:e.moveImage,setMoveImage:e.setMoveImage}};function q(e,t,r,n,a,o,i){try{var s=e[o](i),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,a)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){q(o,n,a,i,s,"next",e)}function s(e){q(o,n,a,i,s,"throw",e)}i(void 0)}))}}function ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ee(e,t,r[t])}))}return e}var re={x:0,y:0,width:0,height:0};function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ae(e,t,r,n,a,o,i){try{var s=e[o](i),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,a)}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||se(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||se(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){if(e){if("string"===typeof e)return ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(e,t):void 0}}var le=0,ce=function(e){var t=E(),r=t.canvasRef,n=t.minimapRef,a=t.bgRef,o=(0,l.NW)(),c=(0,l.av)(),d=c.handleAddMyMove,m=c.handleRemoveMyMove,b=U(),h=b.addSavedMove,p=b.removeSavedMove,x=S(),v=s(),g=W().clearSelection,y=(0,i.useMemo)((function(){var e,t=o.usersMoves,r=o.movesWithoutUser,n=o.myMoves,a=ie(r).concat(ie(n));return t.forEach((function(t){return(e=a).push.apply(e,ie(t))})),a.sort((function(e,t){return e.timestamp-t.timestamp})),a}),[o]),w=function(){if(r.current&&n.current&&a.current){var e=n.current.getContext("2d");e&&(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(a.current,0,0,e.canvas.width,e.canvas.height),e.drawImage(r.current,0,0,e.canvas.width,e.canvas.height))}};(0,i.useEffect)((function(){return w()}),[v]);var j=function(e,t){var r=e.path;if(x&&r.length){var n=e.options;if("select"!==n.mode){switch(x.lineWidth=n.lineWidth,x.strokeStyle=C(n.lineColor),x.fillStyle=C(n.fillColor),"eraser"===n.mode?x.globalCompositeOperation="destination-out":x.globalCompositeOperation="source-over","image"===n.shape&&t&&x.drawImage(t,r[0][0],r[0][1]),n.shape){case"line":x.beginPath(),r.forEach((function(e){var t=oe(e,2),r=t[0],n=t[1];x.lineTo(r,n)})),x.stroke(),x.closePath();break;case"circle":var a=e.circle,o=a.cX,i=a.cY,s=a.radiusX,l=a.radiusY;x.beginPath(),x.ellipse(o,i,s,l,0,0,2*Math.PI),x.stroke(),x.fill(),x.closePath();break;case"rect":var c=e.rect,u=c.width,d=c.height;x.beginPath(),x.rect(r[0][0],r[0][1],u,d),x.stroke(),x.fill(),x.closePath()}w()}}},N=function(){var e,t=(e=K().mark((function e(){var t;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x){e.next=2;break}return e.abrupt("return");case 2:return x.clearRect(0,0,x.canvas.width,x.canvas.height),e.next=5,Promise.all(y.filter((function(e){return"image"===e.options.shape})).map((function(e){return new Promise((function(t){var r=new Image;r.src=e.img.base64,r.id=e.id,r.addEventListener("load",(function(){return t(r)}))}))})));case 5:t=e.sent,y.forEach((function(e){if("image"===e.options.shape){var r=t.find((function(t){return t.id===e.id}));r&&j(e,r)}else j(e)})),w();case 8:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ae(o,n,a,i,s,"next",e)}function s(e){ae(o,n,a,i,s,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();!function(e){var t=S(),r=P(),n=r.selection,a=E(),o=a.bgRef,s=a.selectionRefs,l=Q().setMoveImage;(0,i.useEffect)((function(){var r=function(){var r=V(K().mark((function r(){return K().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t||!n){r.next=4;break}return r.next=3,e();case 3:setTimeout((function(){var e=n.x,r=n.y,a=n.width,o=n.height;t.lineWidth=2,t.strokeStyle="#000",t.setLineDash([5,10]),t.globalCompositeOperation="source-over",t.beginPath(),t.rect(e,r,a,o),t.stroke(),t.closePath(),t.setLineDash([])}),10);case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return re.width===(null===n||void 0===n?void 0:n.width)&&re.height===(null===n||void 0===n?void 0:n.height)&&re.x===(null===n||void 0===n?void 0:n.x)&&re.y===(null===n||void 0===n?void 0:n.y)||r(),function(){n&&(re=n)}}),[n,t]);var c=(0,i.useMemo)((function(){if(n){var e=n.x,t=n.y,r=n.width,a=n.height;return r<0?(r+=4,e-=2):(r-=4,e+=2),a<0?(a+=4,t-=2):(a-=4,t+=2),{x:e,y:t,width:r,height:a}}return{width:0,height:0,x:0,y:0}}),[n]),d=function(){var e=V(K().mark((function e(r){var a,i,s,l,u,d,f,m,b,h,p,x;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",null);case 2:if(a=c.x,i=c.y,s=c.width,l=c.height,!(u=null===t||void 0===t?void 0:t.getImageData(a,i,s,l))){e.next=23;break}if((d=document.createElement("canvas")).width=s,d.height=l,(f=document.createElement("canvas")).width=s,f.height=l,!(m=f.getContext("2d"))||!o.current){e.next=23;break}return(h=null===(b=o.current.getContext("2d"))||void 0===b?void 0:b.getImageData(a,i,s,l))&&r&&m.putImageData(h,0,0),null===(p=d.getContext("2d"))||void 0===p||p.putImageData(u,0,0),m.drawImage(d,0,0),e.next=21,new Promise((function(e){f.toBlob((function(t){t&&e(t)}))}));case 21:return x=e.sent,e.abrupt("return",x);case 23:return e.abrupt("return",null);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){if(!n)return null;var e=c.x,t=c.y,a=c.width,o=c.height;a<0?(a+=4,e-=2):(a-=4,e+=2),o<0?(o+=4,t-=2):(o-=4,t+=2);var i=te({},O,{rect:{width:a,height:o},path:[[e,t]],options:te({},r,{shape:"rect",mode:"eraser",fillColor:{r:0,g:0,b:0,a:1}})});return f.W.emit("draw",i),i},b=function(){var e=V(K().mark((function e(){var t;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(!0);case 2:(t=e.sent)&&navigator.clipboard.write([new ClipboardItem({"image/png":t})]).then((function(){(0,u.Am)("Copied to clipboard!",{position:"top-center",theme:"colored"})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){var e=function(){var e=V(K().mark((function e(t){return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"c"===t.key&&t.ctrlKey&&b(),"Delete"===t.key&&n&&m();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[o,m,t,b,d,r,n]),(0,i.useEffect)((function(){var e=function(){var e=V(K().mark((function e(){var t,r,a,o,i,s;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=10;break}return e.next=3,d();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:r=c.x,a=c.y,o=c.width,i=c.height,(s=new FileReader).readAsDataURL(t),s.addEventListener("loadend",(function(){var e,t=null===(e=s.result)||void 0===e?void 0:e.toString();t&&(m(),l({base64:t,x:Math.min(r,r+o),y:Math.min(a,a+i)}))}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(s.current){var t=s.current[0],r=s.current[1],a=s.current[2];return t.addEventListener("click",e),r.addEventListener("click",b),a.addEventListener("click",m),function(){null===t||void 0===t||t.removeEventListener("click",e),null===r||void 0===r||r.removeEventListener("click",b),null===a||void 0===a||a.removeEventListener("click",m)}}return function(){}}),[m,c,b,d,n,s,l])}(N),(0,i.useEffect)((function(){return f.W.on("your_move",(function(t){e(),d(t),setTimeout(g,100)})),function(){f.W.off("your_move")}}),[e,g,d]),(0,i.useEffect)((function(){if(le>=y.length||!le)N();else{var e=y[y.length-1];if("image"===e.options.shape){var t=new Image;t.src=e.img.base64,t.addEventListener("load",(function(){return j(e,t)}))}else j(e)}return function(){le=y.length}}),[y]);var k=function(){if(x){var e=m();"select"===(null===e||void 0===e?void 0:e.options.mode)?g():e&&(h(e),f.W.emit("undo"))}},A=function(){if(x){var e=p();e&&f.W.emit("draw",e)}};return(0,i.useEffect)((function(){var e=function(e){"z"===e.key&&e.ctrlKey?k():"y"===e.key&&e.ctrlKey&&A()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[k,A]),{handleUndo:k,handleRedo:A}},ue=function(e){var t=e.bgRef,r=s(),a=k(),o=a.x,l=a.y;return(0,i.useEffect)((function(){var e,n=null===(e=t.current)||void 0===e?void 0:e.getContext("2d");if(n){var a="dark"===r.mode?{background:"#0a0b14",body:"#0f1018",gridLines:"#1e293b",accentLines:"#334155"}:{background:"#fefefe",body:"#f8fafc",gridLines:"#e2e8f0",accentLines:"#cbd5e1"};if("dark"===r.mode){var o=n.createLinearGradient(0,0,w,j);o.addColorStop(0,"#0a0b14"),o.addColorStop(.5,"#0f1219"),o.addColorStop(1,"#141827"),n.fillStyle=o}else{var i=n.createRadialGradient(w/2,j/2,0,w/2,j/2,Math.max(w,j)/2);i.addColorStop(0,"#ffffff"),i.addColorStop(.7,"#f8fafc"),i.addColorStop(1,"#f1f5f9"),n.fillStyle=i}if(n.fillRect(0,0,w,j),document.body.style.backgroundColor=a.body,document.body.style.transition="background-color 0.3s ease",r.lines){var s=25;n.save(),n.globalAlpha=.3,n.strokeStyle=a.gridLines,n.lineWidth=.5;for(var l=0;l<j;l+=s)n.beginPath(),n.moveTo(0,l),n.lineTo(w,l),n.stroke();for(var c=0;c<w;c+=s)n.beginPath(),n.moveTo(c,0),n.lineTo(c,j),n.stroke();n.restore(),n.save(),n.globalAlpha=.6,n.strokeStyle=a.accentLines,n.lineWidth=1;for(var u=0;u<j;u+=125)n.beginPath(),n.moveTo(0,u),n.lineTo(w,u),n.stroke();for(var d=0;d<w;d+=125)n.beginPath(),n.moveTo(d,0),n.lineTo(d,j),n.stroke();n.restore(),n.save(),n.fillStyle=a.accentLines,n.globalAlpha=.4;for(var f=0;f<w;f+=125)for(var m=0;m<j;m+=125)n.beginPath(),n.arc(f,m,1,0,2*Math.PI),n.fill();n.restore()}else{n.save(),n.globalAlpha=.02,n.fillStyle="dark"===r.mode?"#ffffff":"#000000";for(var b=0;b<1e3;b++){var h=Math.random()*w,p=Math.random()*j;n.fillRect(h,p,1,1)}n.restore()}}}),[t,r]),(0,n.jsx)(g.E.canvas,{ref:t,width:w,height:j,className:"absolute top-0 transition-all duration-300 ".concat("dark"===r.mode?"shadow-2xl shadow-blue-900/20":"shadow-lg shadow-slate-200/50"),style:{x:o,y:l,filter:"dark"===r.mode?"contrast(1.05) brightness(1.02)":"contrast(1.02) brightness(1.01)"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,ease:"easeInOut"}})},de=function(){var e=E(),t=e.canvasRef,r=e.bgRef,a=e.undoRef,o=e.redoRef,s=N(),c=s.width,u=s.height,d=k(),m=d.x,b=d.y,h=S(),p=(0,i.useState)(!0),x=p[0],v=p[1],O=Z(x),A=O.handleEndDrawing,C=O.handleDraw,I=O.handleStartDrawing,M=O.drawing,R=O.clearOnYourMove;!function(e){var t=(0,l.bo)(),r=t.handleAddMoveToUser,n=t.handleRemoveMoveFromUser;(0,i.useEffect)((function(){var t,n="";return f.W.on("user_draw",(function(a,o){e?(t=a,n=o):r(o,a)})),function(){f.W.off("user_draw"),t&&n&&r(n,t)}}),[e,r]),(0,i.useEffect)((function(){return f.W.on("user_undo",(function(e){n(e)})),function(){f.W.off("user_undo")}}),[n])}(M);var P=ce(R),T=P.handleUndo,W=P.handleRedo;return(0,i.useEffect)((function(){v(!1)}),[]),(0,i.useEffect)((function(){var e=function(e){v(e.ctrlKey)};window.addEventListener("keyup",e),window.addEventListener("keydown",e);var t=a.current,r=o.current;return null===t||void 0===t||t.addEventListener("click",T),null===r||void 0===r||r.addEventListener("click",W),function(){window.removeEventListener("keyup",e),window.removeEventListener("keydown",e),null===t||void 0===t||t.removeEventListener("click",T),null===r||void 0===r||r.removeEventListener("click",W)}}),[t,x,W,T,o,a]),(0,i.useEffect)((function(){h&&f.W.emit("joined_room")}),[h]),(0,n.jsxs)("div",{className:"relative h-full w-full overflow-hidden bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-indigo-900",children:[(0,n.jsx)(g.E.canvas,{ref:t,width:w,height:j,className:"absolute top-0 z-10 rounded-lg transition-all duration-200 ".concat(x?"cursor-move shadow-2xl shadow-blue-500/20 ring-2 ring-blue-400/30":"cursor-crosshair shadow-xl shadow-slate-300/40 hover:shadow-2xl hover:shadow-slate-400/30"),style:{x:m,y:b,filter:x?"brightness(1.05) contrast(1.05)":"brightness(1.02) contrast(1.02)"},drag:x,dragConstraints:{left:-(w-c),right:0,top:-(j-u),bottom:0},dragElastic:.1,dragTransition:{power:.2,timeConstant:150,bounceStiffness:300,bounceDamping:20},whileDrag:{scale:.98,rotate:.5,transition:{duration:.2}},onMouseDown:function(e){return I(e.clientX,e.clientY)},onMouseUp:A,onMouseMove:function(e){C(e.clientX,e.clientY,e.shiftKey)},onTouchStart:function(e){return I(e.changedTouches[0].clientX,e.changedTouches[0].clientY)},onTouchEnd:A,onTouchMove:function(e){return C(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}}),(0,n.jsx)(ue,{bgRef:r}),(0,n.jsxs)(g.E.button,{className:"absolute bottom-14 right-5 z-10 rounded-2xl md:bottom-5 p-4 text-lg font-medium shadow-lg backdrop-blur-sm transition-all duration-300 ".concat(x?"bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-emerald-500/30 ring-2 ring-emerald-400/50":"bg-gradient-to-r from-slate-200 to-slate-300 text-slate-700 shadow-slate-400/30 hover:from-slate-300 hover:to-slate-400 dark:from-slate-700 dark:to-slate-800 dark:text-slate-200 dark:shadow-slate-600/30"),onClick:function(){return v((function(e){return!e}))},whileHover:{scale:1.05,y:-2,transition:{duration:.2}},whileTap:{scale:.95,transition:{duration:.1}},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.3},children:[(0,n.jsx)(g.E.div,{animate:{rotate:x?45:0,scale:x?1.1:1},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsx)(y.Ctn,{className:"drop-shadow-sm"})}),(0,n.jsx)(g.E.div,{className:"absolute -top-1 -right-1 h-3 w-3 rounded-full ".concat(x?"bg-emerald-300":"bg-slate-400"),animate:{scale:x?[1,1.2,1]:1,opacity:x?[.8,1,.8]:.6},transition:{duration:x?1.5:.3,repeat:x?1/0:0,ease:"easeInOut"}})]}),(0,n.jsxs)(g.E.div,{className:"absolute bottom-28 right-5 z-10 rounded-xl px-3 py-2 text-sm font-medium shadow-lg backdrop-blur-sm md:bottom-20 ".concat(x?"bg-emerald-500/90 text-white":"bg-slate-700/90 text-slate-200 dark:bg-slate-200/90 dark:text-slate-700"),initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0,transition:{delay:.7,duration:.3}},exit:{opacity:0,scale:.8,y:10},children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(x?"bg-emerald-300":"bg-slate-400")}),x?"Pan Mode":"Draw Mode"]}),(0,n.jsx)("div",{className:"text-xs opacity-75 mt-1",children:x?"Hold Ctrl to toggle":"Hold Ctrl to pan"})]}),(0,n.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,n.jsx)("div",{className:"absolute top-0 left-0 w-32 h-32 bg-gradient-to-br from-blue-200/20 to-transparent rounded-br-full"}),(0,n.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-purple-200/20 to-transparent rounded-bl-full"}),(0,n.jsx)("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-teal-200/20 to-transparent rounded-tr-full"}),(0,n.jsx)("div",{className:"absolute bottom-0 right-0 w-32 h-32 bg-gradient-to-tl from-pink-200/20 to-transparent rounded-tl-full"})]})]})},fe=r(8933),me=r(3337),be=function(){var e=k(),t=e.x,r=e.y,a=(0,i.useRef)({x:0,y:0}),o=(0,i.useRef)(null),s=(0,fe.Z)(o),l=s.docX,c=s.docY,u=window.matchMedia("(pointer: coarse)").matches;return(0,me.Z)((function(){a.current.x===l&&a.current.y===c||u||(f.W.emit("mouse_move",A(l,t),A(c,r)),a.current={x:l,y:c})}),150),u?null:(0,n.jsxs)(g.E.div,{ref:o,className:"pointer-events-none absolute top-0 left-0 z-50 select-none",animate:{x:l+15,y:c+15},transition:{duration:.05,ease:"linear"},children:[(0,n.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-purple-500/20 via-blue-500/20 to-cyan-500/20 rounded-lg blur-sm"}),(0,n.jsxs)("div",{className:"relative bg-gradient-to-r from-slate-900/95 via-slate-800/95 to-slate-900/95 backdrop-blur-md rounded-lg px-3 py-1.5 border border-white/10 shadow-2xl",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/30 via-blue-500/30 to-cyan-500/30 rounded-lg blur-[1px] -z-10"}),(0,n.jsxs)("div",{className:"flex items-center space-x-1 text-xs font-mono",children:[(0,n.jsx)("span",{className:"text-purple-300 font-semibold",children:"X:"}),(0,n.jsx)("span",{className:"text-white font-bold min-w-[2rem] text-right",children:A(l,t).toFixed(0)}),(0,n.jsx)("span",{className:"text-slate-400 mx-1",children:"|"}),(0,n.jsx)("span",{className:"text-cyan-300 font-semibold",children:"Y:"}),(0,n.jsx)("span",{className:"text-white font-bold min-w-[2rem] text-right",children:A(c,r).toFixed(0)})]}),(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-white/5 to-transparent rounded-lg pointer-events-none"})]}),(0,n.jsx)(g.E.div,{className:"absolute -top-2 -left-2 w-2 h-2 bg-gradient-to-br from-purple-400 to-cyan-400 rounded-full shadow-lg",animate:{scale:[1,1.2,1],opacity:[.8,1,.8]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),(0,n.jsx)(g.E.div,{className:"absolute -top-1 -left-1 w-1 h-1 bg-white/60 rounded-full",animate:{scale:[0,1,0],opacity:[0,1,0]},transition:{duration:1.5,repeat:1/0,delay:.5,ease:"easeOut"}})]})},he=r(1190);function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xe(e){return function(e){if(Array.isArray(e))return pe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ve=function(e){var t,r,a=e.userId,o=(0,l.NW)().users,s=k(),c=(0,i.useState)(""),u=c[0],d=c[1],m=(0,i.useState)(s.x.get()),b=m[0],h=m[1],p=(0,i.useState)(s.y.get()),x=p[0],v=p[1],w=(0,i.useState)({x:-1,y:-1}),j=w[0],N=w[1],E=(0,i.useState)(!1),S=E[0],O=E[1],A=(null===(t=o.get(a))||void 0===t?void 0:t.color)||"#3B82F6",C=(null===(r=o.get(a))||void 0===r?void 0:r.name)||"Anonymous";return(0,i.useEffect)((function(){f.W.on("mouse_moved",(function(e,t,r){r===a&&(N({x:e,y:t}),O(!0),setTimeout((function(){return O(!1)}),2e3))}));var e=function(e,t){e===a&&(d(t),O(!0),setTimeout((function(){d("")}),3e3))};return f.W.on("new_msg",e),function(){f.W.off("mouse_moved"),f.W.off("new_msg",e)}}),[a]),(0,i.useEffect)((function(){return s.x.onChange(h)}),[s.x]),(0,i.useEffect)((function(){return s.y.onChange(v)}),[s.y]),(0,n.jsxs)(g.E.div,{className:"pointer-events-none absolute top-0 left-0 z-20 ".concat(-1===j.x&&"hidden"),style:{color:A},animate:{x:j.x+b,y:j.y+x,scale:S?1:.8,opacity:S?1:.7},transition:{x:{duration:.15,ease:"easeOut"},y:{duration:.15,ease:"easeOut"},scale:{duration:.3,ease:"easeInOut"},opacity:{duration:.3,ease:"easeInOut"}},initial:{scale:0,opacity:0},whileInView:{scale:1,opacity:1,transition:{type:"spring",stiffness:300,damping:20}},children:[(0,n.jsxs)(g.E.div,{className:"relative",animate:{rotate:S?0:-5,scale:S?1.1:1},transition:{duration:.2,ease:"easeInOut"},children:[(0,n.jsx)("div",{className:"absolute inset-0 rounded-full blur-sm opacity-60",style:{backgroundColor:A,filter:"drop-shadow(0 0 8px ".concat(A,"40)")}}),(0,n.jsx)(y.BKo,{className:"-rotate-90 relative z-10 text-xl drop-shadow-lg",style:{filter:"drop-shadow(0 2px 4px ".concat(A,"30)")}}),(0,n.jsx)(g.E.div,{className:"absolute -inset-1 rounded-full opacity-30",style:{backgroundColor:A},animate:{scale:[1,1.5,1],opacity:[.3,0,.3]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})]}),u&&(0,n.jsx)(g.E.div,{className:"absolute top-full left-6 z-30",initial:{opacity:0,scale:.8,y:-10},animate:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:400,damping:25}},exit:{opacity:0,scale:.8,y:-10,transition:{duration:.2}},children:(0,n.jsxs)("div",{className:"relative max-w-xs",children:[(0,n.jsxs)("div",{className:"relative overflow-hidden rounded-xl bg-gradient-to-r from-slate-900/95 to-slate-800/95 dark:from-slate-100/95 dark:to-slate-200/95 px-4 py-2 shadow-xl backdrop-blur-lg ring-1 ring-white/10 dark:ring-black/10",style:{borderLeft:"3px solid ".concat(A),boxShadow:"0 8px 32px ".concat(A,"20, 0 4px 16px rgba(0,0,0,0.2)")},children:[(0,n.jsx)("p",{className:"text-sm font-medium text-white dark:text-slate-800 max-h-20 max-w-[15rem] overflow-hidden text-ellipsis leading-relaxed",children:u}),(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent pointer-events-none"})]}),(0,n.jsx)("div",{className:"absolute -top-2 left-4 w-0 h-0 border-l-8 border-r-8 border-b-8 border-transparent",style:{borderBottomColor:A}}),(0,n.jsx)("div",{className:"absolute -top-1 left-5 w-0 h-0 border-l-6 border-r-6 border-b-6 border-transparent border-b-slate-900/95 dark:border-b-slate-100/95"}),xe(Array(3)).map((function(e,t){return(0,n.jsx)(g.E.div,{className:"absolute w-1 h-1 rounded-full opacity-60",style:{backgroundColor:A,right:"".concat(5+15*t,"px"),top:"-6px"},animate:{y:[-2,-6,-2],opacity:[.3,.8,.3],scale:[.8,1.2,.8]},transition:{duration:1.5+.3*t,repeat:1/0,ease:"easeInOut"}},t)}))]})}),(0,n.jsx)(g.E.div,{className:"absolute top-6 left-2 z-20",initial:{opacity:0,x:-10},animate:{opacity:S?1:.7,x:0,scale:S?1:.9},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsxs)("div",{className:"relative overflow-hidden rounded-lg px-3 py-1 backdrop-blur-sm shadow-lg ring-1 ring-white/20",style:{backgroundColor:"".concat(A,"20"),border:"1px solid ".concat(A,"40")},children:[(0,n.jsx)("p",{className:"text-sm font-semibold drop-shadow-sm",style:{color:A},children:C}),(0,n.jsx)("div",{className:"absolute inset-0 opacity-20 rounded-lg",style:{background:"linear-gradient(45deg, ".concat(A,"30, transparent)")}}),(0,n.jsx)(g.E.div,{className:"absolute -top-1 -right-1 w-2 h-2 rounded-full",style:{backgroundColor:A},animate:{scale:S?[1,1.3,1]:1,opacity:S?[.7,1,.7]:.5},transition:{duration:S?1.5:.3,repeat:S?1/0:0,ease:"easeInOut"}})]})}),(0,n.jsx)(g.E.div,{className:"absolute -inset-4 rounded-full border-2 opacity-0",style:{borderColor:A},animate:S?{scale:[1,2,1],opacity:[.6,0,.6]}:{},transition:{duration:1,ease:"easeOut"}})]})};function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ye(e){return function(e){if(Array.isArray(e))return ge(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ge(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var we=function(){var e=(0,l.NW)().users,t=ye(e.keys()).filter((function(e){return e!==f.W.id}));return(0,n.jsxs)("div",{className:"pointer-events-none absolute inset-0 z-40",children:[(0,n.jsx)(he.M,{children:t.length>0&&(0,n.jsx)(g.E.div,{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 via-purple-500/5 to-cyan-500/5",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1}})}),(0,n.jsx)(he.M,{children:t.length>0&&(0,n.jsx)(g.E.div,{className:"absolute top-4 left-4 z-50 pointer-events-auto",initial:{opacity:0,x:-20,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-20,scale:.8},transition:{duration:.3,ease:"easeOut"},children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute -inset-2 bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-cyan-500/20 rounded-xl blur-lg"}),(0,n.jsx)("div",{className:"relative bg-white/90 backdrop-blur-md rounded-xl px-3 py-2 border border-white/20 shadow-xl",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("div",{className:"flex -space-x-1",children:[t.slice(0,3).map((function(t,r){var a=e.get(t);return(0,n.jsx)(g.E.div,{className:"w-4 h-4 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:(null===a||void 0===a?void 0:a.color)||"#6B7280"},initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1*r,type:"spring",stiffness:300,damping:20}},t)})),t.length>3&&(0,n.jsx)(g.E.div,{className:"w-4 h-4 rounded-full bg-slate-400 border-2 border-white shadow-sm flex items-center justify-center",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,type:"spring",stiffness:300,damping:20},children:(0,n.jsxs)("span",{className:"text-xs text-white font-bold",children:["+",t.length-3]})})]}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("span",{className:"text-xs font-semibold text-slate-700",children:[t.length," Active"]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(g.E.div,{className:"w-1.5 h-1.5 bg-green-500 rounded-full",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),(0,n.jsx)("span",{className:"text-xs text-slate-500",children:"Online"})]})]})]})})]})})}),(0,n.jsx)(he.M,{children:t.map((function(t,r){var a=e.get(t);return(0,n.jsxs)(g.E.div,{initial:{opacity:0,scale:.5,rotate:-180,filter:"blur(4px)"},animate:{opacity:1,scale:1,rotate:0,filter:"blur(0px)"},exit:{opacity:0,scale:.3,rotate:180,filter:"blur(4px)"},transition:{duration:.4,delay:.05*r,ease:"easeOut"},className:"relative",children:[(0,n.jsx)(ve,{userId:t}),(0,n.jsx)(g.E.div,{className:"absolute -inset-2 rounded-full opacity-20",style:{background:"radial-gradient(circle, ".concat((null===a||void 0===a?void 0:a.color)||"#6B7280","40 0%, transparent 70%)")},animate:{scale:[1,1.5,1],opacity:[.2,.1,.2]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.5*r}})]},t)}))}),(0,n.jsx)(he.M,{children:t.length>2&&(0,n.jsx)(g.E.div,{className:"absolute top-4 right-4 z-50 pointer-events-auto",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5,ease:"easeOut"},children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute -inset-2 bg-gradient-to-r from-emerald-500/20 via-teal-500/20 to-cyan-500/20 rounded-xl blur-lg"}),(0,n.jsx)("div",{className:"relative bg-white/90 backdrop-blur-md rounded-xl px-3 py-2 border border-white/20 shadow-xl",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(g.E.div,{className:"w-3 h-3 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full",animate:{rotate:360},transition:{duration:4,repeat:1/0,ease:"linear"}}),(0,n.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Collaborative Mode"})]})})]})})}),(0,n.jsx)(g.E.div,{className:"absolute bottom-4 left-4 z-50 pointer-events-auto",initial:{opacity:0},animate:{opacity:t.length>0?1:0},transition:{duration:.5},children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-green-500/20 to-blue-500/20 rounded-lg blur-sm"}),(0,n.jsx)("div",{className:"relative bg-black/80 backdrop-blur-sm rounded-lg px-2 py-1 border border-white/10",children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("div",{className:"flex space-x-0.5",children:ye(Array(3)).map((function(e,t){return(0,n.jsx)(g.E.div,{className:"w-1 bg-green-500 rounded-full",animate:{height:[2,6,2],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:.2*t,ease:"easeInOut"}},t)}))}),(0,n.jsx)("span",{className:"text-xs text-white font-medium ml-1",children:t.length>0?"Connected":"Solo"})]})})]})})]})},je=r(8193);function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ke(e,t,r[t])}))}return e}function Se(e){return function(e){if(Array.isArray(e))return Ne(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ne(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Oe=function(){var e=E().canvasRef,t=k(),r=t.x,a=t.y,o=Q(),s=o.moveImage,l=o.setMoveImage,u=(0,c.c)(s.x||50),d=(0,c.c)(s.y||50);(0,i.useEffect)((function(){s.x?u.set(s.x):u.set(50),s.y?d.set(s.y):d.set(50)}),[u,d,s.x,s.y]);return s.base64?(0,n.jsxs)(g.E.div,{drag:!0,dragConstraints:e,dragElastic:.1,dragTransition:{power:.08,timeConstant:150,bounceStiffness:400,bounceDamping:25},className:"absolute top-0 z-20 cursor-grab active:cursor-grabbing",style:{x:u,y:d},initial:{scale:.8,opacity:0,rotate:-5},animate:{scale:1,opacity:1,rotate:0,transition:{type:"spring",stiffness:300,damping:20,duration:.5}},whileDrag:{scale:1.05,rotate:2,filter:"brightness(1.1) contrast(1.05)",transition:{duration:.2}},exit:{scale:.8,opacity:0,rotate:5,transition:{duration:.3}},children:[(0,n.jsxs)(g.E.div,{className:"absolute bottom-full mb-4 flex gap-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{delay:.3,duration:.4}},children:[(0,n.jsxs)(g.E.button,{className:"group relative overflow-hidden rounded-full bg-gradient-to-r from-emerald-500 to-teal-500 p-3 text-white shadow-lg shadow-emerald-500/30 backdrop-blur-sm transition-all duration-300 hover:shadow-xl hover:shadow-emerald-500/40",onClick:function(){var e=[A(u.get(),r),A(d.get(),a)],t=e[0],n=e[1],o=Ee({},O,{img:{base64:s.base64},path:[[t,n]],options:Ee({},O.options,{selection:null,shape:"image"})});f.W.emit("draw",o),l({base64:""}),u.set(50),d.set(50)},whileHover:{scale:1.1,y:-2,transition:{duration:.2}},whileTap:{scale:.95,transition:{duration:.1}},children:[(0,n.jsx)(g.E.div,{whileHover:{rotate:360},transition:{duration:.6,ease:"easeInOut"},children:(0,n.jsx)(je.bzc,{className:"text-lg"})}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-full bg-white/20 scale-0 group-hover:scale-100 transition-transform duration-300 ease-out"}),(0,n.jsx)("div",{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap",children:"Place Image"})]}),(0,n.jsxs)(g.E.button,{className:"group relative overflow-hidden rounded-full bg-gradient-to-r from-rose-500 to-pink-500 p-3 text-white shadow-lg shadow-rose-500/30 backdrop-blur-sm transition-all duration-300 hover:shadow-xl hover:shadow-rose-500/40",onClick:function(){return l({base64:""})},whileHover:{scale:1.1,y:-2,transition:{duration:.2}},whileTap:{scale:.95,transition:{duration:.1}},children:[(0,n.jsx)(g.E.div,{whileHover:{rotate:90},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsx)(je.oHP,{className:"text-lg"})}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-full bg-white/20 scale-0 group-hover:scale-100 transition-transform duration-300 ease-out"}),(0,n.jsx)("div",{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap",children:"Cancel"})]})]}),(0,n.jsxs)(g.E.div,{className:"relative overflow-hidden rounded-xl shadow-2xl ring-4 ring-white/50 backdrop-blur-sm hover:ring-8 hover:ring-blue-400/30 transition-all duration-300",whileHover:{scale:1.02,transition:{duration:.3}},children:[(0,n.jsx)("img",{className:"pointer-events-none max-w-xs max-h-64 object-contain rounded-xl",alt:"image to place",src:s.base64,style:{filter:"drop-shadow(0 10px 20px rgba(0,0,0,0.15))"}}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-t from-black/5 to-transparent pointer-events-none"}),(0,n.jsx)("div",{className:"absolute top-2 right-2 w-3 h-3 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full opacity-60 animate-pulse"}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-400/20 via-purple-400/20 to-pink-400/20 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none"})]}),(0,n.jsxs)(g.E.div,{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 flex items-center gap-1 px-3 py-1 bg-slate-800/80 text-white text-xs rounded-full backdrop-blur-sm",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1,transition:{delay:.5,duration:.3}},children:[(0,n.jsx)("div",{className:"w-1 h-1 bg-blue-400 rounded-full animate-pulse"}),(0,n.jsx)("span",{className:"font-medium",children:"Drag to position"}),(0,n.jsx)("div",{className:"w-1 h-1 bg-blue-400 rounded-full animate-pulse"})]}),(0,n.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Se(Array(3)).map((function(e,t){return(0,n.jsx)(g.E.div,{className:"absolute w-1 h-1 bg-blue-400/60 rounded-full",style:{left:"".concat(20+30*t,"%"),top:"".concat(10+20*t,"%")},animate:{y:[-5,-15,-5],opacity:[.3,.8,.3],scale:[.8,1.2,.8]},transition:{duration:2+.5*t,repeat:1/0,ease:"easeInOut"}},t)}))})]}):null},Ae=r(6893);function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ie(e){return function(e){if(Array.isArray(e))return Ce(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Ce(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ce(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Me=function(){var e,t,r=P().selection,a=E().selectionRefs;if(r){var o=r.x,i=r.y,s=r.width,l=r.height;e=Math.min(i,i+l)-50,t=Math.min(o,o+s)}else t=-50,e=-50;var c=[{icon:y.Ctn,label:"Move",gradient:"from-blue-500 to-indigo-600",hoverGradient:"from-blue-600 to-indigo-700",shadow:"shadow-blue-500/30",hoverShadow:"hover:shadow-blue-500/40",index:0},{icon:Ae.C3L,label:"Copy",gradient:"from-emerald-500 to-teal-600",hoverGradient:"from-emerald-600 to-teal-700",shadow:"shadow-emerald-500/30",hoverShadow:"hover:shadow-emerald-500/40",index:1},{icon:je.VPh,label:"Delete",gradient:"from-rose-500 to-pink-600",hoverGradient:"from-rose-600 to-pink-700",shadow:"shadow-rose-500/30",hoverShadow:"hover:shadow-rose-500/40",index:2}];return(0,n.jsxs)(g.E.div,{className:"absolute top-0 left-0 z-50",style:{top:e,left:t},initial:{opacity:0,scale:.8,y:10},animate:{opacity:r?1:0,scale:r?1:.8,y:r?0:10,transition:{type:"spring",stiffness:300,damping:25,duration:.3}},exit:{opacity:0,scale:.8,y:10,transition:{duration:.2}},children:[(0,n.jsxs)("div",{className:"relative flex items-center justify-center gap-3 p-2 rounded-2xl bg-white/80 dark:bg-slate-800/80 backdrop-blur-lg shadow-xl ring-1 ring-black/5 dark:ring-white/10",children:[(0,n.jsx)("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-blue-50/50 via-purple-50/50 to-pink-50/50 dark:from-slate-700/50 dark:via-slate-600/50 dark:to-slate-700/50"}),c.map((function(e,t){var r=e.icon;return(0,n.jsxs)(g.E.button,{className:"group relative overflow-hidden rounded-xl bg-gradient-to-r ".concat(e.gradient," p-3 text-white shadow-lg ").concat(e.shadow," backdrop-blur-sm transition-all duration-300 ").concat(e.hoverShadow," hover:shadow-xl"),ref:function(t){t&&a.current&&(a.current[e.index]=t)},initial:{opacity:0,scale:.5,rotate:-10},animate:{opacity:1,scale:1,rotate:0,transition:{delay:.1*t,type:"spring",stiffness:400,damping:20}},whileHover:{scale:1.1,y:-3,rotate:0===t?45:0,transition:{duration:.2}},whileTap:{scale:.95,transition:{duration:.1}},children:[(0,n.jsx)(g.E.div,{whileHover:"Move"===e.label?{rotate:90}:"Copy"===e.label?{scale:1.2}:"Delete"===e.label?{rotate:[0,-10,10,0]}:{},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsx)(r,{className:"text-lg drop-shadow-sm"})}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-xl bg-white/20 scale-0 group-hover:scale-100 transition-transform duration-300 ease-out"}),(0,n.jsxs)(g.E.div,{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900 text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none",initial:{y:5,opacity:0},whileHover:{y:0,opacity:1},children:[e.label,(0,n.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-slate-900 dark:border-t-slate-100"})]}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-white/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]},e.label)})),(0,n.jsx)(g.E.div,{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 h-0.5 bg-gradient-to-r from-transparent via-blue-400 to-transparent",initial:{width:0},animate:{width:r?"100%":"0%",transition:{delay:.4,duration:.3}}}),(0,n.jsx)("div",{className:"absolute -top-1 -left-1 w-2 h-2 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full opacity-60"}),(0,n.jsx)("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-gradient-to-bl from-pink-400 to-rose-500 rounded-full opacity-60"}),Ie(Array(3)).map((function(e,t){return(0,n.jsx)(g.E.div,{className:"absolute w-1 h-1 bg-blue-400/40 rounded-full",style:{left:"".concat(15+35*t,"%"),top:"-8px"},animate:{y:[-2,-8,-2],opacity:[.2,.6,.2],scale:[.5,1,.5]},transition:{duration:2+.3*t,repeat:1/0,ease:"easeInOut"}},t)}))]}),r&&(0,n.jsx)(g.E.div,{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0.5 h-3 bg-gradient-to-b from-slate-400 to-transparent",initial:{scaleY:0},animate:{scaleY:1,transition:{delay:.5,duration:.3}}})]})},Re=r(9583),Pe=r(1515),Te=r(2348),We=function(){var e=(0,i.useState)(""),t=e[0],r=e[1],a=(0,i.useState)(!1),o=a[0],s=a[1],l=!t.trim();return(0,n.jsxs)("form",{className:"flex w-full items-center gap-3",onSubmit:function(e){e.preventDefault(),t.trim()&&(f.W.emit("send_msg",t),r(""))},children:[(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)(g.E.div,{className:"absolute -inset-0.5 bg-gradient-to-r from-blue-500 via-purple-500 to-cyan-500 rounded-2xl blur-sm opacity-0",animate:{opacity:o?.4:0},transition:{duration:.3}}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{className:"w-full rounded-2xl border-2 border-slate-200 bg-white/80 backdrop-blur-sm px-5 py-3 pr-4 text-slate-800 placeholder-slate-400 shadow-lg transition-all duration-300 focus:border-transparent focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:shadow-xl hover:border-slate-300 hover:shadow-md",placeholder:"Type your message...",value:t,onChange:function(e){return r(e.target.value)},onFocus:function(){return s(!0)},onBlur:function(){return s(!1)}}),t.length>0&&(0,n.jsx)(g.E.div,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:t.length})]})]}),(0,n.jsxs)(g.E.button,{className:"relative flex h-12 w-12 items-center justify-center overflow-hidden rounded-2xl bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 text-white shadow-lg transition-all duration-300 hover:shadow-xl active:scale-95 disabled:cursor-not-allowed disabled:opacity-50",type:"submit",disabled:l,whileHover:{scale:l?1:1.05},whileTap:{scale:l?1:.95},children:[(0,n.jsx)(g.E.div,{className:"absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-cyan-500",animate:{background:["linear-gradient(to right, rgb(59, 130, 246), rgb(147, 51, 234), rgb(6, 182, 212))","linear-gradient(to right, rgb(147, 51, 234), rgb(6, 182, 212), rgb(59, 130, 246))","linear-gradient(to right, rgb(6, 182, 212), rgb(59, 130, 246), rgb(147, 51, 234))"]},transition:{duration:4,repeat:1/0,ease:"linear"}}),(0,n.jsx)("div",{className:"relative",children:l?(0,n.jsx)(g.E.div,{initial:{opacity:0,rotate:-90},animate:{opacity:1,rotate:0},transition:{duration:.3},children:(0,n.jsx)(je.gYb,{className:"text-lg opacity-60"})}):(0,n.jsx)(g.E.div,{initial:{opacity:0,rotate:-90,scale:.8},animate:{opacity:1,rotate:0,scale:1},transition:{type:"spring",stiffness:300,damping:20},whileHover:{rotate:[0,-10,10,0],transition:{duration:.5}},children:(0,n.jsx)(je.gYb,{className:"text-lg"})})}),(0,n.jsx)(g.E.div,{className:"absolute inset-0 rounded-2xl bg-white/20",initial:{scale:0,opacity:.5},animate:{scale:1,opacity:0},transition:{duration:.6,repeat:1/0,repeatDelay:1}})]}),t.length>0&&(0,n.jsx)(g.E.div,{className:"absolute -top-8 left-4 flex space-x-1",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},children:[0,1,2].map((function(e){return(0,n.jsx)(g.E.div,{className:"h-1.5 w-1.5 rounded-full bg-blue-500",animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:.2*e,ease:"easeInOut"}},e)}))})]})},De=function(e){var t=e.userId,r=e.msg,a=e.username,o=e.color,i=f.W.id===t;return(0,n.jsxs)(g.E.div,{className:"group my-3 flex gap-3 ".concat(i?"justify-end":"justify-start"),initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.3,ease:"easeOut"},whileHover:{scale:1.01},children:[(0,n.jsxs)("div",{className:"flex max-w-[80%] ".concat(i?"flex-row-reverse":"flex-row"," items-end gap-2"),children:[!i&&(0,n.jsxs)(g.E.div,{className:"relative flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full shadow-lg",style:{backgroundColor:o,boxShadow:"0 0 0 2px ".concat(o,"20, 0 4px 12px ").concat(o,"30")},whileHover:{scale:1.1},transition:{type:"spring",stiffness:300,damping:30},children:[(0,n.jsx)("span",{className:"text-xs font-bold text-white",children:a.charAt(0).toUpperCase()}),(0,n.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 h-3 w-3 rounded-full bg-green-500 border-2 border-white shadow-sm",children:(0,n.jsx)(g.E.div,{className:"h-full w-full rounded-full bg-green-400",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})})]}),(0,n.jsxs)("div",{className:"flex flex-col ".concat(i?"items-end":"items-start"),children:[!i&&(0,n.jsxs)(g.E.div,{className:"mb-1 flex items-center gap-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:[(0,n.jsx)("span",{className:"text-xs font-bold opacity-80",style:{color:o},children:a}),(0,n.jsx)("div",{className:"h-1 w-1 rounded-full bg-slate-300"}),(0,n.jsx)("span",{className:"text-xs text-slate-400",children:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,n.jsxs)(g.E.div,{className:"relative max-w-full rounded-2xl px-4 py-2.5 shadow-lg ".concat(i?"rounded-br-md bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 text-white":"rounded-bl-md bg-white border border-slate-200 text-slate-800"),initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1,type:"spring",stiffness:300,damping:25},children:[i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.E.div,{className:"absolute inset-0 rounded-2xl rounded-br-md bg-gradient-to-r from-blue-500 via-purple-500 to-cyan-500 opacity-0 group-hover:opacity-100",transition:{duration:.3}}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)("p",{className:"text-sm font-medium leading-relaxed break-words",children:r})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.E.div,{className:"absolute inset-0 rounded-2xl rounded-bl-md bg-gradient-to-r from-slate-50 to-blue-50 opacity-0 group-hover:opacity-100",transition:{duration:.3}}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)("p",{className:"text-sm leading-relaxed break-words",children:r})})]}),(0,n.jsx)("div",{className:"absolute bottom-0 h-3 w-3 ".concat(i?"-right-1 bg-gradient-to-br from-blue-600 to-cyan-600":"-left-1 bg-white border-l border-b border-slate-200"," rotate-45 transform")})]}),i&&(0,n.jsx)(g.E.div,{className:"mt-1 text-xs text-slate-400",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),i&&(0,n.jsxs)(g.E.div,{className:"relative flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 via-purple-500 to-cyan-500 shadow-lg",whileHover:{scale:1.1},transition:{type:"spring",stiffness:300,damping:30},children:[(0,n.jsx)("span",{className:"text-xs font-bold text-white",children:"You"}),(0,n.jsx)("div",{className:"absolute -inset-1 rounded-full bg-gradient-to-br from-blue-500/30 via-purple-500/30 to-cyan-500/30 blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]}),(0,n.jsx)(g.E.div,{className:"absolute -bottom-2 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200",initial:{scale:0},animate:{scale:1},transition:{delay:.3},children:(0,n.jsx)("div",{className:"flex space-x-1"})})]})};function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Le(e,t,r[t])}))}return e}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return _e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _e(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Fe=function(){var e=(0,l.NW)(),t=(0,i.useRef)(null),r=(0,i.useState)(!1),a=r[0],o=r[1],s=(0,i.useState)(!1),c=s[0],u=s[1],d=ze((0,Pe.Z)([]),2),m=d[0],b=d[1];return(0,i.useEffect)((function(){var r=function(r,n){var a,i,s=e.users.get(r);b.push({userId:r,msg:n,id:m.length+1,username:(null===s||void 0===s?void 0:s.name)||"Anonymous",color:(null===s||void 0===s?void 0:s.color)||"#000"}),null===(a=t.current)||void 0===a||a.scroll({top:null===(i=t.current)||void 0===i?void 0:i.scrollHeight}),c||o(!0)};return f.W.on("new_msg",r),function(){f.W.off("new_msg",r)}}),[b,m,c,e.users]),(0,n.jsxs)(g.E.div,{className:"absolute bottom-0 z-50 flex h-[300px] w-full flex-col overflow-hidden sm:left-36 sm:w-[30rem]",animate:{y:c?0:260},transition:{ease:Te.n,duration:.2},children:[(0,n.jsx)("div",{className:"absolute -inset-2 bg-gradient-to-t from-blue-500/20 via-purple-500/10 to-transparent rounded-t-2xl blur-xl"}),(0,n.jsxs)(g.E.button,{className:"relative flex w-full cursor-pointer items-center justify-between overflow-hidden rounded-t-2xl bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 py-4 px-6 font-bold text-white shadow-2xl border-b border-white/10",onClick:function(){u((function(e){return!e})),o(!1)},whileHover:{scale:1.01},whileTap:{scale:.98},children:[(0,n.jsx)(g.E.div,{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 via-purple-600/20 to-cyan-600/20",animate:{background:["linear-gradient(to right, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.2), rgba(6, 182, 212, 0.2))","linear-gradient(to right, rgba(147, 51, 234, 0.2), rgba(6, 182, 212, 0.2), rgba(59, 130, 246, 0.2))","linear-gradient(to right, rgba(6, 182, 212, 0.2), rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.2))"]},transition:{duration:8,repeat:1/0,ease:"linear"}}),(0,n.jsxs)("div",{className:"relative flex items-center gap-3",children:[(0,n.jsx)(g.E.div,{animate:{rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:(0,n.jsx)(y.Nm2,{className:"text-xl text-blue-400"})}),(0,n.jsx)("span",{className:"text-lg font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent",children:"Chat"}),a&&(0,n.jsxs)(g.E.div,{className:"relative",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:[(0,n.jsx)("div",{className:"absolute -inset-1 bg-gradient-to-r from-green-400 to-emerald-400 rounded-full blur-sm opacity-60"}),(0,n.jsx)("div",{className:"relative rounded-full bg-gradient-to-r from-green-500 to-emerald-500 px-3 py-1 text-xs font-bold text-white shadow-lg",children:(0,n.jsx)(g.E.span,{animate:{opacity:[1,.7,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"New!"})})]})]}),(0,n.jsx)(g.E.div,{className:"relative text-slate-300",animate:{rotate:c?0:180},transition:{ease:Te.n,duration:.3},children:(0,n.jsx)(Re.RiI,{className:"text-lg"})})]}),(0,n.jsxs)("div",{className:"relative flex flex-1 flex-col justify-between bg-gradient-to-b from-white via-slate-50 to-white backdrop-blur-md border-x border-b border-white/20 shadow-2xl",children:[(0,n.jsx)("div",{className:"absolute inset-0 opacity-5 bg-[radial-gradient(circle_at_1px_1px,_rgba(0,0,0,0.15)_1px,_transparent_0)] bg-[length:20px_20px]"}),(0,n.jsx)("div",{className:"relative h-[190px] overflow-y-auto p-4 space-y-2 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent hover:scrollbar-thumb-slate-400",ref:t,children:0===m.length?(0,n.jsxs)(g.E.div,{className:"flex flex-col items-center justify-center h-full text-slate-500",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,n.jsx)("div",{className:"text-4xl mb-2 opacity-50",children:"\ud83d\udcac"}),(0,n.jsx)("p",{className:"text-sm font-medium",children:"No messages yet"}),(0,n.jsx)("p",{className:"text-xs text-slate-400",children:"Start the conversation!"})]}):m.map((function(e,t){return(0,n.jsx)(g.E.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.3,delay:.05*t,ease:"easeOut"},children:(0,n.jsx)(De,Ue({},e))},e.id)}))}),(0,n.jsxs)("div",{className:"relative border-t border-slate-200 bg-gradient-to-r from-white via-slate-50 to-white p-4",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/5 via-purple-500/5 to-cyan-500/5"}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(We,{})})]})]}),(0,n.jsx)("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 w-3/4 h-4 bg-gradient-to-r from-transparent via-blue-500/20 to-transparent blur-lg rounded-full"})]})},Ye=r(1163),Xe=r(1513),He=r(100),Be=function(){var e=(0,l.u4)(),t=(0,Xe.d)().openModal,r=(0,i.useState)(""),a=r[0],o=r[1],s=(0,i.useState)(!1),c=s[0],u=s[1],d=(0,i.useState)(null),m=d[0],b=d[1],h=(0,Ye.useRouter)(),p=(h.query.roomId||"").toString();(0,i.useEffect)((function(){if(p)return f.W.emit("check_room",p),f.W.on("room_exists",(function(e){b(e),e||setTimeout((function(){return h.push("/")}),1500)})),function(){f.W.off("room_exists")}}),[p,h]),(0,i.useEffect)((function(){var r=function(r,a){u(!1),a?(h.push("/"),t((0,n.jsx)(He.Z,{id:r}))):e(r)};return f.W.on("joined",r),function(){f.W.off("joined",r)}}),[t,h,e]);return null===m?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 relative overflow-hidden",children:[(0,n.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,n.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl animate-pulse-slow"}),(0,n.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-purple-500/10 rounded-full blur-3xl animate-pulse-slow",style:{animationDelay:"1s"}})]}),(0,n.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(59,130,246,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(59,130,246,0.03)_1px,transparent_1px)] bg-[size:50px_50px]"}),(0,n.jsx)("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-screen",children:(0,n.jsxs)("div",{className:"text-center animate-fade-in-up",children:[(0,n.jsx)("div",{className:"w-16 h-16 border-4 border-blue-500/30 border-t-blue-500 rounded-full animate-spin mx-auto mb-6"}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-slate-200 mb-2",children:"Checking room..."}),(0,n.jsx)("p",{className:"text-slate-400",children:"Please wait while we verify the room exists"})]})})]}):!1===m?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-red-950 to-slate-900 relative overflow-hidden",children:[(0,n.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,n.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-red-500/10 rounded-full blur-3xl animate-pulse-slow"}),(0,n.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-orange-500/10 rounded-full blur-3xl animate-pulse-slow",style:{animationDelay:"1s"}})]}),(0,n.jsx)("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-screen",children:(0,n.jsxs)("div",{className:"text-center animate-fade-in-up",children:[(0,n.jsxs)("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6 relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-red-500/20 rounded-full animate-ping"}),(0,n.jsx)("div",{className:"relative w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-white text-xl font-bold",children:"!"})})]}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-slate-200 mb-2",children:"Room Not Found"}),(0,n.jsx)("p",{className:"text-slate-400 mb-4",children:"This room doesn't exist or has been deleted"}),(0,n.jsx)("p",{className:"text-slate-500 text-sm",children:"Redirecting you back to home..."})]})})]}):(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 relative overflow-hidden",children:[(0,n.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,n.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl animate-pulse-slow"}),(0,n.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-purple-500/10 rounded-full blur-3xl animate-pulse-slow",style:{animationDelay:"1s"}}),(0,n.jsx)("div",{className:"absolute top-1/3 left-1/4 w-60 h-60 bg-pink-500/5 rounded-full blur-3xl animate-pulse-slow",style:{animationDelay:"2s"}})]}),(0,n.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(59,130,246,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(59,130,246,0.03)_1px,transparent_1px)] bg-[size:50px_50px]"}),(0,n.jsxs)("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-screen px-6 py-12",children:[(0,n.jsxs)("div",{className:"text-center mb-12 animate-fade-in-up",children:[(0,n.jsxs)("div",{className:"relative inline-block mb-6",children:[(0,n.jsx)("h1",{className:"text-5xl md:text-7xl font-black bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent leading-tight",children:"Digiboard"}),(0,n.jsx)("div",{className:"absolute -inset-4 bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-pink-500/20 blur-2xl -z-10"})]}),(0,n.jsx)("p",{className:"text-xl md:text-2xl text-slate-300 font-light leading-relaxed mb-4",children:"Real-time whiteboard collaboration"}),(0,n.jsxs)("div",{className:"inline-flex items-center gap-3 px-6 py-3 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 shadow-lg",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsx)("p",{className:"text-sm text-slate-400",children:"Joining Room"}),(0,n.jsx)("p",{className:"text-lg font-mono text-blue-400 font-semibold",children:p})]})]})]}),(0,n.jsx)("div",{className:"w-full max-w-sm",children:(0,n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a.trim()&&(u(!0),f.W.emit("join_room",p,a))},className:"floating-panel space-y-6 animate-fade-in-up",style:{animationDelay:"0.2s"},children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("label",{htmlFor:"name-input",className:"block text-sm font-semibold text-slate-200 flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-1 h-4 bg-gradient-to-b from-blue-400 to-purple-400 rounded-full"}),"Enter your name"]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{id:"name-input",className:"input w-full pl-12 pr-12 text-lg",placeholder:"Your creative name...",value:a,onChange:function(e){return o(e.target.value.slice(0,15))},maxLength:15,disabled:c}),(0,n.jsx)("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400",children:"\ud83d\udc64"}),(0,n.jsxs)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-slate-500",children:[a.length,"/15"]})]})]}),(0,n.jsx)("button",{type:"submit",disabled:!a.trim()||c,className:"btn btn-primary w-full text-lg font-semibold relative overflow-hidden group disabled:opacity-50 disabled:cursor-not-allowed",children:c?(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Joining Room..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"relative z-10 flex items-center justify-center gap-2",children:"\ud83d\ude80 Enter Room"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),(0,n.jsx)("button",{type:"button",onClick:function(){return h.push("/")},disabled:c,className:"btn w-full text-sm font-medium border-slate-600 hover:border-slate-500 text-slate-300 hover:text-slate-200 disabled:opacity-50",children:"\u2190 Back to Home"})]})}),(0,n.jsx)("div",{className:"mt-12 max-w-md mx-auto animate-fade-in-up",style:{animationDelay:"0.4s"},children:(0,n.jsx)("div",{className:"p-6 bg-slate-800/30 backdrop-blur-sm rounded-2xl border border-slate-700/30",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-blue-500/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,n.jsx)("span",{className:"text-blue-400 text-sm",children:"\u2139\ufe0f"})}),(0,n.jsxs)("div",{className:"text-slate-400 text-sm leading-relaxed",children:[(0,n.jsx)("p",{className:"font-medium text-slate-300 mb-2",children:"Almost there!"}),(0,n.jsx)("p",{children:"Just enter your name and you'll join the collaborative whiteboard. Your name will be visible to other participants in the room."})]})]})})}),(0,n.jsx)("div",{className:"mt-8 text-center animate-fade-in-up",style:{animationDelay:"0.6s"},children:(0,n.jsx)("p",{className:"text-slate-500 text-sm",children:"Ready to collaborate? \u2728"})})]})]})},$e=r(3854),Je=r(3990),Ze=r(1649);function Ge(e,t,r,n,a,o,i){try{var s=e[o](i),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,a)}var Ke=function(){var e=(0,l.NW)().id,t=(0,Xe.d)().closeModal,r=(0,i.useState)(""),a=r[0],o=r[1],s=(0,i.useState)(!1),c=s[0],u=s[1],d=(0,i.useState)(""),f=d[0],m=d[1];(0,i.useEffect)((function(){o(window.location.href),m("https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=".concat(encodeURIComponent(window.location.href)))}),[]);var b=function(){var e,t=(e=K().mark((function e(){return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(a);case 3:u(!0),setTimeout((function(){return u(!1)}),2e3),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to copy: ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ge(o,n,a,i,s,"next",e)}function s(e){Ge(o,n,a,i,s,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),h=function(t){var r="Join me on this collaborative drawing canvas! Room ID: ".concat(e),n=encodeURIComponent(a),o=encodeURIComponent(r),i={whatsapp:"https://wa.me/?text=".concat(o,"%20").concat(n),twitter:"https://twitter.com/intent/tweet?text=".concat(o,"&url=").concat(n),facebook:"https://www.facebook.com/sharer/sharer.php?u=".concat(n),email:"mailto:?subject=Join my drawing canvas&body=".concat(o,"%0A%0A").concat(a)};window.open(i[t],"_blank","width=600,height=400")},p=function(e){var t=e.icon,r=e.label,a=e.onClick,o=e.color,i=void 0===o?"bg-gray-100 hover:bg-gray-200":o;return(0,n.jsxs)("button",{onClick:a,className:"flex items-center gap-3 p-3 rounded-xl transition-all duration-200 hover:scale-105 ".concat(i," group"),children:[(0,n.jsx)("span",{className:"text-lg",children:t}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900",children:r})]})};return(0,n.jsxs)("div",{className:"relative flex flex-col rounded-2xl bg-gradient-to-br from-white to-blue-50 p-8 shadow-2xl max-w-md mx-auto",children:[(0,n.jsx)("button",{onClick:t,className:"absolute top-6 right-6 p-2 rounded-full hover:bg-gray-100 transition-colors duration-200 group",children:(0,n.jsx)(je.oHP,{className:"w-5 h-5 text-gray-500 group-hover:text-gray-700"})}),(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center",children:(0,n.jsx)(Ae.PMT,{className:"w-8 h-8 text-white"})}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Share Canvas"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Invite others to collaborate on your drawing"})]}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-xl border border-blue-100",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(Ae.WY8,{className:"text-blue-600"}),(0,n.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Room Information"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"Room ID:"}),(0,n.jsx)("p",{className:"font-mono font-bold text-lg text-blue-700",children:e})]}),(0,n.jsx)("img",{src:f,alt:"QR Code",className:"w-12 h-12 rounded border border-gray-200",onError:function(e){e.target.style.display="none"}})]})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[(0,n.jsx)(Ae.XKb,{}),"Share Link"]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"text",value:a,readOnly:!0,className:"w-full px-4 py-3 pr-24 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,n.jsxs)("button",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 ".concat(c?"bg-green-100 text-green-700 hover:bg-green-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"),onClick:b,children:[c?(0,n.jsx)(Ae.UgA,{className:"w-4 h-4"}):(0,n.jsx)(Ae.C3L,{className:"w-4 h-4"}),c?"Copied!":"Copy"]})]})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[(0,n.jsx)(Ae.PMT,{}),"Quick Share"]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsx)(p,{icon:(0,n.jsx)(y.RGt,{className:"text-green-600"}),label:"WhatsApp",onClick:function(){return h("whatsapp")},color:"bg-green-50 hover:bg-green-100"}),(0,n.jsx)(p,{icon:(0,n.jsx)(Ae.Imn,{className:"text-gray-600"}),label:"Email",onClick:function(){return h("email")},color:"bg-gray-50 hover:bg-gray-100"}),(0,n.jsx)(p,{icon:(0,n.jsx)(y.meP,{className:"text-blue-400"}),label:"Twitter",onClick:function(){return h("twitter")},color:"bg-blue-50 hover:bg-blue-100"}),(0,n.jsx)(p,{icon:(0,n.jsx)(y.k1O,{className:"text-blue-600"}),label:"Facebook",onClick:function(){return h("facebook")},color:"bg-blue-50 hover:bg-blue-100"})]})]}),(0,n.jsxs)("div",{className:"text-center pt-4 border-t border-gray-200",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-3",children:[(0,n.jsx)(y.$k$,{className:"text-gray-600"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"QR Code"})]}),(0,n.jsx)("div",{className:"inline-block p-3 bg-white rounded-xl border border-gray-200 shadow-sm",children:(0,n.jsx)("img",{src:f,alt:"QR Code for sharing",className:"w-24 h-24 rounded",onError:function(e){var t=e.target;t.parentElement&&(t.parentElement.innerHTML='<div class="w-24 h-24 bg-gray-100 rounded flex items-center justify-center text-gray-400 text-xs">QR Code</div>')}})}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Scan to join the canvas"})]})]})},Qe=r(471),qe=function(){var e=(0,Xe.d)().closeModal,t=function(){var e=(0,a.Zl)(o);return function(t,r){e({mode:t,lines:r})}}(),r=s();(0,i.useEffect)((function(){return e}),[r,e]);var l=function(e,t,r){var n=null===e||void 0===e?void 0:e.getContext("2d");if(n&&(n.fillStyle="dark"===t?"#222":"#fff",n.fillRect(0,0,n.canvas.width,n.canvas.height),r)){n.lineWidth=1,n.strokeStyle="dark"===t?"#444":"#ddd";for(var a=0;a<n.canvas.height;a+=10)n.beginPath(),n.moveTo(0,a),n.lineTo(n.canvas.width,a),n.stroke();for(var o=0;o<n.canvas.width;o+=10)n.beginPath(),n.moveTo(o,0),n.lineTo(o,n.canvas.height),n.stroke()}};return(0,n.jsxs)("div",{className:"relative flex flex-col items-center rounded-md bg-white p-10",children:[(0,n.jsx)("button",{onClick:e,className:"absolute top-5 right-5",children:(0,n.jsx)(je.oHP,{})}),(0,n.jsx)("h2",{className:"mb-4 text-2xl font-bold",children:"Choose background"}),(0,n.jsxs)("div",{className:"grid gap-5 sm:grid-cols-2",children:[(0,n.jsx)("canvas",{className:"h-48 w-64 cursor-pointer rounded-md border-2",tabIndex:0,width:256,height:192,onClick:function(){return t("dark",!0)},ref:function(e){return l(e,"dark",!0)}}),(0,n.jsx)("canvas",{className:"h-48 w-64 cursor-pointer rounded-md border-2",tabIndex:0,width:256,height:192,onClick:function(){return t("light",!0)},ref:function(e){return l(e,"light",!0)}}),(0,n.jsx)("canvas",{className:"h-48 w-64 cursor-pointer rounded-md border-2",tabIndex:0,width:256,height:192,onClick:function(){return t("dark",!1)},ref:function(e){return l(e,"dark",!1)}}),(0,n.jsx)("canvas",{className:"h-48 w-64 cursor-pointer rounded-md border-2",tabIndex:0,width:256,height:192,onClick:function(){return t("light",!1)},ref:function(e){return l(e,"light",!1)}})]})]})},Ve=function(){var e=(0,Xe.d)().openModal;return(0,n.jsx)("button",{className:"btn-icon",onClick:function(){return e((0,n.jsx)(qe,{}))},children:(0,n.jsx)(Qe.bTn,{})})},et=r(5907),tt=r(9293),rt={from:{y:-30,opacity:0,transition:{ease:Te.n,duration:.2}},to:{y:0,opacity:1,transition:{ease:Te.n,duration:.2}}};function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function at(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){at(e,t,r[t])}))}return e}function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var st=function(){var e=it(T(),2),t=e[0],r=e[1],a=(0,i.useRef)(null),o=(0,i.useState)(!1),s=o[0],l=o[1];return(0,tt.Z)(a,(function(){return l(!1)})),(0,n.jsxs)("div",{className:"relative flex items-center",ref:a,children:[(0,n.jsx)("button",{className:"btn-icon",onClick:function(){return l(!s)},disabled:"select"===t.mode,children:(0,n.jsx)(y.woE,{})}),(0,n.jsx)(he.M,{children:s&&(0,n.jsxs)(g.E.div,{className:"absolute left-10 mt-24 sm:left-14",variants:rt,initial:"from",animate:"to",exit:"from",children:[(0,n.jsx)("h2",{className:"ml-3 font-semibold text-black dark:text-white",children:"Line color"}),(0,n.jsx)(et.Jg,{color:t.lineColor,onChange:function(e){r(ot({},t,{lineColor:e}))},className:"mb-5"}),(0,n.jsx)("h2",{className:"ml-3 font-semibold text-black dark:text-white",children:"Fill color"}),(0,n.jsx)(et.Jg,{color:t.fillColor,onChange:function(e){r(ot({},t,{fillColor:e}))}})]})})]})},lt=function(){var e=E(),t=e.redoRef,r=e.undoRef,o=(0,l.av)().myMoves,i=(0,a.sJ)(D);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"btn-icon text-xl",ref:t,disabled:!i.length,children:(0,n.jsx)(Re.WLu,{})}),(0,n.jsx)("button",{className:"btn-icon text-xl",ref:r,disabled:!o.length,children:(0,n.jsx)(Re.wXW,{})})]})},ct=r(6770),ut=r.n(ct),dt=function(e,t){ut().imageFileResizer(e,700,700,"WEBP",100,0,(function(e){t(e.toString())}),"base64")},ft=function(){var e=Q().setMoveImage;(0,i.useEffect)((function(){var t=function(t){var r,n=null===(r=t.clipboardData)||void 0===r?void 0:r.items;if(n){var a=!0,o=!1,i=void 0;try{for(var s,l=n[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;if(c.type.includes("image")){var u=c.getAsFile();u&&dt(u,(function(t){return e({base64:t})}))}}}catch(d){o=!0,i=d}finally{try{a||null==l.return||l.return()}finally{if(o)throw i}}}};return document.addEventListener("paste",t),function(){document.removeEventListener("paste",t)}}),[e]);return(0,n.jsx)("button",{className:"btn-icon text-xl",onClick:function(){var t=document.createElement("input");t.type="file",t.accept="image/*",t.click(),t.addEventListener("change",(function(){if(t&&t.files){var r=t.files[0];dt(r,(function(t){return e({base64:t})}))}}))},children:(0,n.jsx)(y.vGR,{})})};function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var pt=function(){var e=ht(T(),2),t=e[0],r=e[1],a=(0,i.useRef)(null),o=(0,i.useState)(!1),s=o[0],l=o[1];return(0,tt.Z)(a,(function(){return l(!1)})),(0,n.jsxs)("div",{className:"relative flex items-center",ref:a,children:[(0,n.jsx)("button",{className:"btn-icon text-xl",onClick:function(){return l(!s)},disabled:"select"===t.mode,children:(0,n.jsx)(y.S2O,{})}),(0,n.jsx)(he.M,{children:s&&(0,n.jsx)(g.E.div,{className:"absolute top-[6px] left-14 w-36",variants:rt,initial:"from",animate:"to",exit:"from",children:(0,n.jsx)("input",{type:"range",min:1,max:20,value:t.lineWidth,onChange:function(e){return r((function(t){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){bt(e,t,r[t])}))}return e}({},t,{lineWidth:parseInt(e.target.value,10)})}))},className:"h-4 w-full cursor-pointer appearance-none rounded-lg bg-gray-200"})})})]})};function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){vt(e,t,r[t])}))}return e}function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return xt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var wt=function(){var e=yt(T(),2),t=e[0],r=e[1],a=W().clearSelection;return(0,i.useEffect)((function(){a()}),[t.mode]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"btn-icon text-xl ".concat("draw"===t.mode&&"bg-green-400"),onClick:function(){r((function(e){return gt({},e,{mode:"draw"})}))},children:(0,n.jsx)(y.Aac,{})}),(0,n.jsx)("button",{className:"btn-icon text-xl ".concat("eraser"===t.mode&&"bg-green-400"),onClick:function(){r((function(e){return gt({},e,{mode:"eraser"})}))},children:(0,n.jsx)(Re.arg,{})}),(0,n.jsx)("button",{className:"btn-icon text-2xl ".concat("select"===t.mode&&"bg-green-400"),onClick:function(){r((function(e){return gt({},e,{mode:"select"})}))},children:(0,n.jsx)(je.AJi,{})})]})},jt=r(7516);function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var St=function(){var e=Et(T(),2),t=e[0],r=e[1],a=(0,i.useRef)(null),o=(0,i.useState)(!1),s=o[0],l=o[1];(0,tt.Z)(a,(function(){return l(!1)}));var c=function(e){r((function(t){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){kt(e,t,r[t])}))}return e}({},t,{shape:e})})),l(!1)};return(0,n.jsxs)("div",{className:"relative flex items-center",ref:a,children:[(0,n.jsxs)("button",{className:"btn-icon text-2xl",disabled:"select"===t.mode,onClick:function(){return l((function(e){return!e}))},children:["circle"===t.shape&&(0,n.jsx)(y.b9R,{}),"rect"===t.shape&&(0,n.jsx)(jt.v3P,{}),"line"===t.shape&&(0,n.jsx)(Qe.slm,{})]}),(0,n.jsx)(he.M,{children:s&&(0,n.jsxs)(g.E.div,{className:"absolute left-14 z-10 flex gap-1 rounded-lg border bg-zinc-900 p-2 md:border-0",variants:rt,initial:"from",animate:"to",exit:"from",children:[(0,n.jsx)("button",{className:"btn-icon text-2xl",onClick:function(){return c("line")},children:(0,n.jsx)(Qe.slm,{})}),(0,n.jsx)("button",{className:"btn-icon text-2xl",onClick:function(){return c("rect")},children:(0,n.jsx)(jt.v3P,{})}),(0,n.jsx)("button",{className:"btn-icon text-2xl",onClick:function(){return c("circle")},children:(0,n.jsx)(y.b9R,{})})]})})]})},Ot=function(){var e=E(),t=e.canvasRef,r=e.bgRef,a=(0,Xe.d)().openModal,o=N().width,s=(0,i.useState)(!1),l=s[0],c=s[1],u=(0,Ye.useRouter)();(0,i.useEffect)((function(){c(o>=1024)}),[o]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.E.button,{className:"btn-icon absolute bottom-1/2 -left-2 z-50 h-10 w-10 rounded-full bg-black text-2xl transition-none lg:hidden",animate:{rotate:l?0:180},transition:{duration:.2,ease:Te.n},onClick:function(){return c(!l)},children:(0,n.jsx)(Ae.Tfp,{})}),(0,n.jsxs)(g.E.div,{className:"absolute left-10 top-[50%] z-50 grid grid-cols-2 items-center gap-5 rounded-lg bg-zinc-900 p-5 text-white 2xl:grid-cols-1",animate:{x:l?0:-160,y:"-50%"},transition:{duration:.2,ease:Te.n},children:[(0,n.jsx)(lt,{}),(0,n.jsx)("div",{className:"h-px w-full bg-white 2xl:hidden"}),(0,n.jsx)("div",{className:"h-px w-full bg-white"}),(0,n.jsx)(St,{}),(0,n.jsx)(st,{}),(0,n.jsx)(pt,{}),(0,n.jsx)(wt,{}),(0,n.jsx)(ft,{}),(0,n.jsx)("div",{className:"2xl:hidden"}),(0,n.jsx)("div",{className:"h-px w-full bg-white 2xl:hidden"}),(0,n.jsx)("div",{className:"h-px w-full bg-white"}),(0,n.jsx)(Ve,{}),(0,n.jsx)("button",{className:"btn-icon text-2xl",onClick:function(){return a((0,n.jsx)(Ke,{}))},children:(0,n.jsx)(Ze.qSo,{})}),(0,n.jsx)("button",{className:"btn-icon text-2xl",onClick:function(){var e=document.createElement("canvas");e.width=w,e.height=j;var n=e.getContext("2d");n&&t.current&&r.current&&(n.drawImage(r.current,0,0),n.drawImage(t.current,0,0));var a=document.createElement("a");a.href=e.toDataURL("image/png"),a.download="canvas.png",a.click()},children:(0,n.jsx)($e.yFZ,{})}),(0,n.jsx)("button",{className:"btn-icon text-xl",onClick:function(){return u.push("/")},children:(0,n.jsx)(Je.T$9,{})})]})]})};function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ct(e){return function(e){if(Array.isArray(e))return At(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return At(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return At(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var It=function(){var e=(0,l.NW)().users;return(0,n.jsx)("div",{className:"pointer-events-none absolute z-30 flex p-5",children:Ct(e.keys()).map((function(t,r){var a,o;return(0,n.jsx)("div",{className:"flex h-5 w-5 select-none items-center justify-center rounded-full text-xs text-white md:h-8 md:w-8 md:text-base lg:h-12 lg:w-12",style:{backgroundColor:(null===(a=e.get(t))||void 0===a?void 0:a.color)||"black",marginLeft:0!==r?"-0.5rem":0},children:(null===(o=e.get(t))||void 0===o?void 0:o.name.split("")[0])||"A"},t)}))})},Mt=function(){var e=(0,l.NW)();s();return e.id?(0,n.jsx)(v,{children:(0,n.jsxs)("div",{className:"relative h-full w-full overflow-hidden",children:[(0,n.jsx)(It,{}),(0,n.jsx)(Ot,{}),(0,n.jsx)(Me,{}),(0,n.jsx)(Oe,{}),(0,n.jsx)(de,{}),(0,n.jsx)(be,{}),(0,n.jsx)(we,{}),(0,n.jsx)(Fe,{})]})}):(0,n.jsx)(Be,{})},Rt=function(){return(0,n.jsx)(Mt,{})}}},function(e){e.O(0,[617,866,609,556,445,955,13,874,871,186,774,888,179],(function(){return t=1040,e(e.s=t);var t}));var t=e.O();_N_E=t}]);